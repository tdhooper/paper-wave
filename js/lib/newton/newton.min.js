!function(a){"use strict";function b(a){return this instanceof b?(this.particles=[],this.edges=[],this.constraints=[],this.material=a,this.simulator=void 0,this.simParticles=[],this.simEdges=[],this.simConstraints=[],void 0):new b(a)}b.prototype.addTo=function(a){if(this.simulator)throw new Error("Not implemented: reparenting a body");this.simParticles=a.particles,this.simEdges=a.edges,this.simParticles.push.apply(this.simParticles,this.particles),this.simEdges.push.apply(this.simEdges,this.edges),this.simulator=a},b.prototype.addParticle=function(a){this.particles.push(a),this.simParticles.push(a)},b.prototype.Particle=function(){var b=a.Particle.apply(a.Particle,Array.prototype.slice.call(a.Particle,arguments));return this.addParticle(b),b},b.prototype.addEdge=function(a){this.edges.push(a),this.simEdges.push(a)},b.prototype.Edge=function(){var b=a.Edge.apply(a.Edge,Array.prototype.slice.call(a.Edge,arguments));return this.addEdge(b),b},b.prototype.addConstraint=function(a){this.constraints.push(a),this.simConstraints.push(a)},b.prototype.DistanceConstraint=function(){var b=a.DistanceConstraint.apply(a.DistanceConstraint,Array.prototype.slice.call(a.DistanceConstraint,arguments));return this.addConstraint(b),b},b.prototype.each=function(a,b){for(var c,d=this.particles.length;d--;)c=this.particles[d],c[a].apply(c,b)},b.prototype.callback=function(a){for(var b=this.particles.length;b--;)a(this.particles[b])},a.Body=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a,c,d){return this instanceof b?(this.p1=a,this.p2=c,this.distance=d,void 0):new b(a,c,d)}b.prototype.resolve=function(){var a=this.p1.position,b=this.p2.position,c=b.clone().sub(a),d=c.getLength(),e=(d-this.distance)/(2.1*d),f=c.scale(e);this.p1.correct(f),f.scale(-1),this.p2.correct(f)},a.DistanceConstraint=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(c,d,e){return this instanceof b?(this.p1=c,this.p2=d,this.material=e||Material.simple,this.compute(),this._rect=new a.Rectangle(0,0,0,0),void 0):new b(c,d,e)}b.COLLISION_TOLERANCE=.5,b.getAbc=function(a,b,c,d){var e=d-b,f=a-c,g=e*a+f*b;return{a:e,b:f,c:g}},b.prototype.compute=function(){this.anchor=this.p1.position.clone(),this.vector=this.p2.position.clone().sub(this.p1.position),this.length=this.vector.getLength(),this.angle=this.vector.getAngle(),this.normal=this.vector.clone().turnLeft().unit(),this.unit=this.vector.clone().unit(),this.bounds=a.Rectangle.fromVectors(this.p1.position,this.p2.position).expand(b.COLLISION_TOLERANCE)},b.prototype.getCoords=function(){return{x1:this.p1.position.x,y1:this.p1.position.y,x2:this.p2.position.x,y2:this.p2.position.y}},b.prototype.getRepelled=function(b,c){return new a.Vector(b,c).add(this.normal)},b.prototype.getProjection=function(a){var b=this.vector.getDot(a);return this.unit.clone().scale(b)},b.prototype.getAngleDelta=function(a){return this.angle-a.getAngle()},b.prototype.getAbc=function(){return b.getAbc(this.p1.position.x,this.p1.position.y,this.p2.position.x,this.p2.position.y)},b.prototype.findIntersection=function(c,d,e,f){var g=this.bounds,h=this._rect.set(c,d,e,f).expand(b.COLLISION_TOLERANCE);if(!g.overlaps(h))return!1;var i=this.getAbc(),j=b.getAbc(c,d,e,f),k=i.a*j.b-j.a*i.b;if(0===k)return!1;var l=(j.b*i.c-i.b*j.c)/k,m=(i.a*j.c-j.a*i.c)/k;if(!g.contains(l,m)||!h.contains(l,m))return!1;var n=a.Vector.scratch.set(e-c,f-d).getDot(this.normal);return n>=0?!1:{x:l,y:m}},b.prototype.getReflection=function(a,b){var c=this.normal.clone(),d=this.material.friction,e=c.multScalar(a.getDot(c)).multScalar(b),f=a.clone().sub(e).multScalar(1-d),g=f.sub(e);return g},a.Edge=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-d)),e=setTimeout(function(){a(b+c)},c);return d=b+c,e}function c(a){clearTimeout(a)}var d=0;if("undefined"!=typeof window){var e=["ms","moz","webkit","o"],f=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,!!window.chrome&&!f;for(var g=0;g<e.length&&!window.requestAnimationFrame;++g)window.requestAnimationFrame=window[e[g]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[g]+"CancelAnimationFrame"]||window[e[g]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=b,window.cancelAnimationFrame=c),a.frame=window.requestAnimationFrame.bind(window),a.cancelFrame=window.cancelAnimationFrame.bind(window)}else a.frame=b,a.cancelFrame=c}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(){return this instanceof b?(this.bodies=[],this.forces=[],this.watchedLayers=[this],this.wrapper=void 0,this.container=void 0,this.cachedParticles=[],this.cachedForces=[],this.cachedEdges=[],void 0):new b}b.prototype.respondTo=function(a){return this.watchedLayers=a||[],this},b.prototype.addForce=function(a){return this.forces.push(a),this},b.prototype.wrapIn=function(a){return this.wrapper=a,this},b.prototype.containBy=function(a){return this.container=a,this},b.prototype.addBody=function(a){return this.bodies.push(a),this},b.prototype.collect=function(){var a,b,c,d,e=this.cachedParticles,f=this.cachedForces,g=this.cachedEdges,h=this.bodies,i=this.watchedLayers;for(e.length=0,f.length=0,g.length=0,a=0,b=h.length;b>a;a++)e.push.apply(e,h[a].particles);for(a=0,b=this.watchedLayers.length;b>a;a++)for(f.push.apply(f,i[a].forces),c=0,d=i[a].bodies.length;d>c;c++)g.push.apply(g,i[a].bodies[c].edges)},b.prototype.integrate=function(a){for(var b,c=this.cachedParticles,d=this.cachedForces,e=0,f=c.length;f>e;e++){b=c[e];for(var g=0,h=d.length;h>g;g++)d[g].applyTo(b);b.integrate(a)}},b.prototype.constrain=function(){for(var a=this.cachedParticles,b=0,c=a.length;c>b;b++)this.wrapper&&a[b].wrap(this.wrapper),this.container&&a[b].contain(this.container)},b.prototype.collide=function(){for(var a=this.cachedParticles,b=this.cachedEdges,c=0,d=a.length;d>c;c++)a[c].collide(b)},a.Layer=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(c,d,e){return this instanceof b?(this.angle=c,this.strength=d,this.vector=new a.Vector(0,d).rotate(c),this.simulator=void 0,void 0):new b(c,d,e)}b.prototype.addTo=function(a){a.forces.push(this),this.simulator=a},b.prototype.setAngle=function(a){this.angle=a,this.vector.set(0,this.strength).rotate(this.angle)},b.prototype.setStrength=function(a){this.strength=a,this.vector.set(0,this.strength).rotate(this.angle)},b.prototype.applyTo=function(a){a.accelerateVector(this.vector)},a.LinearGravity=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a){return this instanceof b?(a=a||{},this.weight=a.weight||1,this.restitution=a.restitution||1,this.friction=a.friction||0,this.maxVelocity=a.maxVelocity||100,this.maxVelocitySquared=this.maxVelocity*this.maxVelocity,void 0):new b(a)}b.prototype.setMaxVelocity=function(a){return this.maxVelocity=a,this.maxVelocitySquared=a*a,this},b.simple=new b,a.Material=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a,b){return(a%b+b)%b}function c(b,d,e,f){return this instanceof c?(this.position=new a.Vector(b,d),this.lastPosition=this.position.clone(),this.lastValidPosition=this.position.clone(),this.velocity=new a.Vector(0,0),this.acceleration=new a.Vector(0,0),this.material=f||a.Material.simple,this.size=e||1,this.randomDrag=Math.random()*c.randomness+1e-10,this.pinned=!1,this.colliding=!1,void 0):new c(b,d,e,f)}c.randomness=25,c.prototype.integrate=function(a){this.velocity.copy(this.position).sub(this.lastPosition);var b=Math.min(1,this.velocity.getSquaredLength()/(this.material.maxVelocitySquared+this.randomDrag));this.velocity.scale(1-b),this.acceleration.scale(1-b).scale(a*a),this.lastPosition.copy(this.position),this.position.add(this.velocity).add(this.acceleration),this.acceleration.zero(),this.lastValidPosition.copy(this.lastPosition),this.colliding=!1},c.prototype.placeAt=function(a,b){return this.position.set(a,b),this.lastPosition.copy(this.position),this.lastValidPosition.copy(this.lastPosition),this},c.prototype.correct=function(a){this.position.add(a)},c.prototype.moveBy=function(a,b){return this.lastPosition=this.position.clone(),this.position.add(a,b),this},c.prototype.pin=function(a,b){a="undefined"!=typeof a?a:this.position.x,b="undefined"!=typeof b?b:this.position.y,this.placeAt(a,b),this.pinned=!0},c.prototype.setVelocity=function(a,b){return this.lastPosition.copy(this.position).subXY(a,b),this},c.prototype.contain=function(a){this.position.x>a.right?this.position.x=this.lastPosition.x=this.lastValidPosition.x=a.right:this.position.x<a.left&&(this.position.x=this.lastPosition.x=this.lastValidPosition.x=a.left),this.position.y>a.bottom?this.position.y=this.lastPosition.y=this.lastValidPosition.y=a.bottom:this.position.y<a.top&&(this.position.y=this.lastPosition.y=this.lastValidPosition.y=a.top)},c.prototype.wrap=function(a){var c=this.position.clone().sub(this.lastPosition),d=b(this.position.x,a.width)+a.left,e=b(this.position.y,a.height)+a.top;this.lastPosition.x=this.lastValidPosition.x=d-c.x,this.lastPosition.y=this.lastValidPosition.y=e-c.y,this.position.x=d,this.position.y=e},c.prototype.applyForce=function(a){this.accelerateVector(a.vector)},c.prototype.accelerateVector=function(a){this.acceleration.add(a)},c.prototype.force=function(a,b,c){c=c||this.getMass(),this.acceleration.add({x:a/c,y:b/c})},c.prototype.getMass=function(){return this.size*this.material.weight},c.prototype.getSquaredSpeed=function(){return this.velocity.getSquaredLength()},c.prototype.attractSquare=function(b,c,d,e){var f=this.getMass(),g=new a.Vector(b,c).sub(this.position),h=Math.max(g.getLength(),e||1),i=d*f/(h*h),j=d/(d+f);this.acceleration.add({x:-i*(g.x/h)*j,y:-i*(g.y/h)*j})},c.prototype.collide=function(a){for(var b,c,d,e,f,g,h,i=a.length;i--;)h=this===a[i].p1||this===a[i].p2,c=!h&&a[i].findIntersection(this.lastPosition.x,this.lastPosition.y,this.position.x,this.position.y),c&&(d=c.x-this.lastPosition.x,e=c.y-this.lastPosition.y,b?(f=b.dx*b.dx+b.dy*b.dy,g=d*d+e*e,f>g&&(b={dx:d,dy:e,x:c.x,y:c.y,wall:a[i]})):b={dx:d,dy:e,x:c.x,y:c.y,wall:a[i]});if(b){var j=this.position.clone().sub(this.lastPosition),k=b.wall.getRepelled(b.x,b.y),l=b.wall.getReflection(j,this.material.restitution);return this.position.copy(k),this.setVelocity(l.x,l.y),this.lastValidPosition=k,this.colliding=!0,b}},a.Particle=c}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a,b,c){return(1<<24)+(a<<16)+(b<<8)+c}function c(a,b,d){return this instanceof c?(this.stage=new PIXI.Stage(0,!0),this.stage.setInteractive(!0),this.width=b,this.height=d,this.renderer=PIXI.autoDetectRenderer(this.width,this.height,null,!1,!0),this.renderer.view.style.display="block",a.appendChild(this.renderer.view),this.infoText=new PIXI.Text("FPS: ??",{fill:"#ffffff",font:"10pt Helvetica"}),this.stage.addChild(this.infoText),this.graphics=new PIXI.Graphics,this.stage.addChild(this.graphics),this.callback=this.callback.bind(this),void 0):new c(a,b,d)}c.prototype={callback:function(a,b){var c=0,d=0;this.graphics.clear();for(var e=0,f=b.layers.length;f>e;e++){for(var g=0,h=b.layers[e].bodies.length;h>g;g++)c+=this.drawParticles(b.layers[e].bodies[g].particles),d+=this.drawEdges(b.layers[e].bodies[g].edges);this.drawForces(b.layers[e].forces)}this.infoText.setText("FPS: "+b.fps+"\nparticles: "+c+"\nedges: "+d),this.renderer.render(this.stage)},drawForces:function(b){this.graphics.lineStyle(2,16777215,.3);for(var c=0,d=b.length;d>c;c++){var e=b[c];e instanceof a.RadialGravity&&(this.graphics.beginFill(16777215,.2),this.graphics.drawCircle(e.x,e.y,.5*e.strength*e.strength),this.graphics.endFill())}},drawParticles:function(a){for(var c,d,e,f,g,h=0,i=a.length;i>h;h++)c=a[h],d=c.position,e=c.lastValidPosition,f=c.getMass(),g=~~(128*((f-1)/5)),c.colliding?this.graphics.lineStyle(f,b(255,255,100),1):this.graphics.lineStyle(f,b(255,28+g,108+g),1),this.graphics.moveTo(e.x-1,e.y),this.graphics.lineTo(d.x+1,d.y);return a.length},drawEdges:function(a){this.graphics.lineStyle(1,16777215,.5);for(var b,c=a.length;c--;)b=a[c].getCoords(),this.graphics.moveTo(b.x1,b.y1),this.graphics.lineTo(b.x2,b.y2);return a.length}},a.PixiRenderer=c}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a,c,d,e){return this instanceof b?(this.x=a,this.y=c,this.strength=d,void 0):new b(a,c,d,e)}b.prototype.setLocation=function(a,b){this.x=a,this.y=b},b.prototype.setStrength=function(a){this.strength=a},b.prototype.applyTo=function(a){a.attractSquare(this.x,this.y,this.strength,20)},a.RadialGravity=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a,c,d,e){return this instanceof b?(this.set.apply(this,arguments),void 0):new b(a,c,d,e)}b.fromVectors=function(a,c){return new b(a.x,a.y,c.x,c.y)},b.prototype={set:function(a,b,c,d){return this.left=Math.min(a,c),this.top=Math.min(b,d),this.right=Math.max(c,a),this.bottom=Math.max(d,b),this.width=this.right-this.left,this.height=this.bottom-this.top,this},contains:function(a,b){return a>=this.left&&a<=this.right&&b>=this.top&&b<=this.bottom},overlaps:function(a){return!(a.left>this.right||a.right<this.left||a.top>this.bottom||a.bottom<this.top)},expand:function(a){return this.left-=a,this.right+=a,this.top-=a,this.bottom+=a,this}},a.Rectangle=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a){return this instanceof b?(this.ctx=a.getContext("2d"),this.width=a.width,this.height=a.height,this.callback=this.callback.bind(this),void 0):new b(a)}b.prototype={callback:function(a,b){var c=this.ctx;this.clear(c,a),this.drawConstraints(c,b.constraints),this.drawEdges(c,b.edges),this.drawParticles(c,b.particles),this.drawForces(c,b.forces),this.drawCounts(c,b.particles.length,b.edges.length),this.drawFPS(c,b)},clear:function(a){a.save(),a.fillStyle="#000000",a.fillRect(0,0,this.width,this.height),a.restore()},drawForces:function(b,c){b.save(),b.lineWidth=2,b.strokeStyle="rgba(255, 255, 255, 0.25)",b.fillStyle="rgba(255, 255, 255, 0.15)";for(var d=0,e=c.length;e>d;d++){var f=c[d];f instanceof a.RadialGravity&&(b.beginPath(),b.arc(f.x,f.y,.5*f.strength*f.strength,0,2*Math.PI,!1),b.fill())}b.restore()},drawParticles:function(a,b){var c,d,e,f,g;a.save(),a.lineCap="butt";for(var h=0,i=b.length;i>h;h++)c=b[h],d=c.position,e=c.lastValidPosition,f=c.getMass(),g=~~(128*((f-1)/5)),a.beginPath(),a.lineWidth=f,a.strokeStyle=c.colliding?"rgba(255, 255, 100, 1)":"rgba("+[255,28+g,108+g].join(",")+", 1)",a.moveTo(e.x,e.y),a.lineTo(d.x,d.y+2),a.stroke();return a.restore(),b.length},drawConstraints:function(a,b){var c;a.save(),a.strokeStyle="rgba(100, 100, 255, 0.25)",a.lineWidth=1;for(var d=0,e=b.length;e>d;d++)c=b[d].getCoords(),a.beginPath(),a.moveTo(c.x1,c.y1),a.lineTo(c.x2,c.y2),a.closePath(),a.stroke();a.restore()},drawEdges:function(a,b){a.save(),a.strokeStyle="rgba(255, 255, 255, 0.2)",a.lineWidth=1;for(var c,d=b.length;d--;)c=b[d].getCoords(),a.beginPath(),a.moveTo(c.x1,c.y1),a.lineTo(c.x2,c.y2),a.closePath(),a.stroke();return a.restore(),b.length},drawCounts:function(a,b,c){a.save(),a.fillStyle="#fff",a.font="10pt Helvetica",a.fillText("Particles: "+b,10,20),a.fillText("Edges: "+c,10,40),a.restore()},drawFPS:function(a,b){var c="FPS: "+b.fps;a.save(),a.fillStyle="#fff",a.font="10pt Helvetica",a.fillText(c,10,60),a.restore()}},a.Renderer=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(){}function c(a,d,e,f){return this instanceof c?(this.preSimulator=a||b,this.renderer=d||b,this.step=this._step.bind(this),this.lastTime=0,this.running=!1,this.fps=0,this.frames=0,this.countTime=0,this.countInterval=250,this.accumulator=0,this.simulationStep=1e3/(e||60),this.iterations=f||3,this.layers=[],this.particles=[],this.edges=[],this.forces=[],this.constraints=[],void 0):new c(a,d,e,f)}c.prototype.start=function(){this.running=!0,this.countTime=Date.now()+1e3,a.frame(this.step)},c.prototype.stop=function(){this.running=!1},c.prototype.simulate=function(a){return this.preSimulator(a,this),this.integrate(a),void 0},c.prototype.integrate=function(a){for(var b,c=this.particles,d=this.forces,e=0,f=c.length;f>e;e++){b=c[e];for(var g=0,h=d.length;h>g;g++)b.applyForce(d[g]);b.integrate(a)}},c.prototype.constrain=function(a){for(var b=this.constraints,c=0,d=b.length;d>c;c++)b[c].resolve(a);this.wrap(this.wrapper),this.contain(this.container)},c.prototype.collide=function(){for(var a=this.particles,b=this.edges,c=0,d=a.length;d>c;c++)a[c].collide(b)},c.prototype.add=function(a){return a.addTo(this),this},c.prototype.wrap=function(a){if(a)for(var b=this.particles,c=0,d=this.particles.length;d>c;c++)b[c].wrap(a)},c.prototype.containBy=function(a){return this.container=a,this},c.prototype.contain=function(a){if(a)for(var b=this.particles,c=0,d=this.particles.length;d>c;c++)b[c].contain(a)},c.prototype.addBody=function(a){this.particles.push.apply(this.particles,a.particles),this.edges.push.apply(this.edges,a.edges),this.bodies.push(a)},c.prototype.Layer=function(){var b=a.Layer();return this.layers.push(b),b},c.prototype._step=function(){if(this.running){var b=Date.now(),c=b-this.lastTime;for(c>100&&(c=0),this.accumulator+=c;this.accumulator>=this.simulationStep;)this.simulate(this.simulationStep),this.accumulator-=this.simulationStep;this.renderer(c,this),this.frames++,b>=this.countTime&&(this.fps=(1e3*(this.frames/(this.countInterval+b-this.countTime))).toFixed(0),this.frames=0,this.countTime=b+this.countInterval),this.lastTime=b,a.frame(this.step)}},a.Simulator=c}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports),function(a){"use strict";function b(a,c){return this instanceof b?(this.x=a,this.y=c,void 0):new b(a,c)}b.scratch=new b,b.prototype.clone=function(){return new a.Vector(this.x,this.y)},b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this},b.prototype.zero=function(){return this.x=0,this.y=0,this},b.prototype.set=function(a,b){return this.x=a,this.y=b,this},b.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},b.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},b.prototype.subXY=function(a,b){return this.x-=a,this.y-=b,this},b.prototype.mult=b.prototype.multVector=function(a){return this.x*=a.x,this.y*=a.y,this},b.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},b.prototype.div=function(a){return this.x/=a.x,this.y/=a.y,this},b.prototype.multScalar=b.prototype.scale=function(a){return this.x*=a,this.y*=a,this},b.prototype.unit=function(){return this.scale(1/this.getLength()),this},b.prototype.turnRight=function(){var a=this.x,b=this.y;return this.x=-b,this.y=a,this},b.prototype.turnLeft=function(){var a=this.x,b=this.y;return this.x=b,this.y=-a,this},b.prototype.rotate=function(a){var b=this.x,c=this.y,d=Math.sin(a),e=Math.cos(a);return this.x=b*e-c*d,this.y=b*d+c*e,this},b.prototype.getDot=function(a){return this.x*a.x+this.y*a.y},b.prototype.getCross=function(a){return this.x*a.y+this.y*a.x},b.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},b.prototype.getSquaredLength=function(){return this.x*this.x+this.y*this.y},b.prototype.getAngle=function(){return Math.atan2(this.y,this.x)},a.Vector=b}("undefined"==typeof exports?this.Newton=this.Newton||{}:exports);